<!DOCTYPE html>
<html ng-app="DrCrunch" ng-strict-di>
  <head lang="en">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>DrCrunch</title>
    <%= stylesheet_tag 'app' %>
  </head>
  <body ng-controller="AppCtrl">
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">DrCrunch</a>
        </div>
      </div>
    </nav>

    <div class="jumbotron">
      <div class="container">        
        <div ng-file-drop ng-file-select ng-model="files" ng-multiple="true" drag-over-class="hover" accept=".jpg,.png,.pdf" class="file-drop">+</div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-sm-12 form-inline compression-form">
          <h3>Pngquant</h3>
          <div class="form-group">
            <label>
              Minimum Quality
              <input ng-model="compression.pngquant.quality_min" type="range" min="0" max="100" >
            </label>
          </div>
          <div class="form-group">
            <input type="text" readonly ng-model="compression.pngquant.quality_min" class="form-control" style="width: 50px;">
          </div>

          <div class="form-group">
            <label>
              Maximum Quality
              <input ng-model="compression.pngquant.quality_max" type="range" min="0" max="100" >
            </label>
          </div>
          <div class="form-group">
            <input type="text" readonly ng-model="compression.pngquant.quality_max" class="form-control" style="width: 50px;">
        </div>
      </div>
    </div>

    <div ng-repeat="file in files" class="container-fluid">
      <div ng-if="!file.images" class="progress">
        <div class="progress-bar progress-bar-striped active" role="progressbar" style="width: 100%;">{{file.name}}</div>
      </div>


      <div ng-repeat="image in file.images" class="row">
        <div class="image-info col-sm-2">
          <hr ng-if="!image.original" />

          <code ng-if="image.original">
            {{file.name}}
          </code>

          <dl>
            <dd>File Size:</dd>
            <dt>{{image.size}}</dt> 
          </dl>

          <button ng-click="crunch(file.images[0])"  ng-if="image.original" class="btn btn-success btn-lg btn-block">Compress Image</button>
        </div>

        <div class="image-container col-sm-10">
          <img ng-src="{{image.url}}">
        </div>

      </div>

      <hr />

    </div>

    <%= javascript_tag 'app' %>
  </body>
</html>
